{% extends "app_taller/base.html" %}
{% load static %}
{% block title %}Salida de vehículo{% endblock %}

{% block content %}
  <h2>Salida de vehículo</h2>
  <p class="muted">Registra la salida del vehículo y confirma que la entrega fue exitosa.</p>

  <section class="card">
    <form method="post" novalidate>
      {% csrf_token %}

      <div class="form-grid-2">
        <div class="form-group">
          <label>Patente <span class="tag-pill required">●</span></label>
          <input type="text" name="patente" placeholder="Ej: AB1234" required>
        </div>

        <div class="form-group">
          <label>Conductor</label>
          <select name="conductor">
            <option value="">-- Seleccionar conductor (opcional) --</option>
            {% for c in conductores %}
              <option value="{{ c.id }}">{{ c.nombre_completo }}</option>
            {% endfor %}
          </select>
        </div>

        <div class="form-group full-row">
          <label>Fecha y hora de salida</label>
          <input id="fecha_salida" type="text" name="fecha_salida" placeholder="Selecciona fecha y hora">
          <small class="muted">Si lo dejas vacío se tomará la hora actual.</small>
        </div>
      </div>

      <div style="display:flex; gap:.5rem; margin-top:12px;">
        <a href="{% url 'dashboard' %}" class="btn">Cancelar</a>
        <button type="submit" class="btn btn-primary">Confirmar salida</button>
      </div>
    </form>
  </section>

{% endblock %}

{% block extra_js %}
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // init flatpickr con fecha y hora
      if (window.flatpickr) {
        flatpickr("#fecha_salida", {
          enableTime: true,
          dateFormat: "Y-m-d H:i",
          locale: "es",
          time_24hr: true,
        });
      }
    });
  </script>
{% endblock %}
